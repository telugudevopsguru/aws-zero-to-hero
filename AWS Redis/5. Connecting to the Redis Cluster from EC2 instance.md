#### INSTRUCTOR DETAILS

|  Information             | Details                                                                      |
|----------------------    |------------------------------------------------------------------------------|
| **Name**                 | Moole Muralidhara Reddy                                                      |
| **Email**                | telugudevopsguru@gmail.com                                                |
| **Website**              | https://www.telugudevopsguru.com               |
| **LinkedIn profile**     | [Moole Muralidhara Reddy](https://www.linkedin.com/in/moole-muralidhara-reddy) |

## 🚀 Connecting to the Redis Cluster from an EC2 Instance (Amazon Linux 2 and 2023)

## ✅ Option 1: Install `redis-cli` Using `amazon-linux-extras`

Amazon Linux 2 does **not** include Redis in its core repositories, but you can enable the EPEL repository to install it:

```bash
# Step 1: Enable EPEL repository
sudo amazon-linux-extras install epel -y

# Step 2: Install Redis (includes redis-cli)
sudo yum install redis -y
```

🔍 **Verify installation:**

```bash
redis-cli --version
```

> ℹ️ *Note:* This installs both the Redis **server** and the **CLI**. If you only need the CLI, you can uninstall the server or just ignore the Redis server binary.

## ✅ Option 2: Compile `redis-cli` from Source (for Latest Version)

If you need a **newer redis-cli version**, compile it from source:

```bash
# Step 1: Install build tools and dependencies
sudo yum groupinstall "Development Tools" -y
sudo yum install gcc jemalloc-devel -y

# Step 1.1 : Install the OpenSSL development libraries
sudo yum install openssl-devel -y

# Step 2: Download and extract latest Redis source
cd /tmp
curl -O http://download.redis.io/redis-stable.tar.gz
tar xzvf redis-stable.tar.gz
cd redis-stable

# Step 3: Build redis-cli with TLS support
make BUILD_TLS=yes

# Step 4: Move redis-cli to a system-wide path
sudo cp src/redis-cli /usr/local/bin/
```

✅ **Verify:**

```bash
redis-cli --version
```

## 🔗 Connecting to Redis Cluster (TLS)

Once installed, connect to the AWS ElastiCache Redis endpoints using TLS:

### 🔸 Using AWS Endpoints

```bash
redis-cli --tls -h your-redis-primary-endpoint.amazonaws.com -p 6379 --tls --insecure -a your-redis-auth-password
redis-cli --tls -h your-redis-reader-endpoint.amazonaws.com -p 6379 --tls --insecure -a your-redis-auth-password
```

### 🔸 Using Route53 DNS Records

```bash
redis-cli --tls -h tf-dev-redis-um.telugudevopsguru.in -p 6379 --tls --insecure -a your-redis-auth-password
redis-cli --tls -h tf-dev-redis-um-r.telugudevopsguru.in -p 6379 --tls --insecure -a your-redis-auth-password
```

> 🔐 *Note:* Ensure you use `--tls --insecure` only for internal/trusted environments. For production, use properly signed certificates and avoid `--insecure`.


## ✅ Option 3: Use `stunnel` as a TLS Proxy

If you can’t use a modern `redis-cli` that supports TLS, use `stunnel` as a workaround:

### 🔧 Step-by-step:

1. **Install `stunnel`:**

```bash
sudo yum install stunnel -y
```

2. **Create `stunnel.conf`:**

```ini
[redis-cli-tls]
client = yes
accept = 127.0.0.1:6379
connect = your-redis-endpoint.amazonaws.com:6379
```

3. **Start `stunnel`:**

```bash
stunnel stunnel.conf
```

4. **Connect to Redis via local tunnel:**

```bash
redis-cli -h 127.0.0.1 -p 6379 -a your-redis-auth-password
```

## 🧪 Troubleshooting & Best Practices

* ✅ Check **Security Groups** and **VPC/Subnet** configuration.
* ✅ Ensure **TLS support** in the redis-cli (`--tls` flag).
* ✅ Validate **auth password** (`-a` flag).
* ✅ Prefer **redis-cli v7+** for compatibility with Redis 7.x clusters.
